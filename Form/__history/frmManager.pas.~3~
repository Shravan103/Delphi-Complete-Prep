unit frmManager;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.Imaging.jpeg,
  Vcl.ExtCtrls, Vcl.Grids, Vcl.DBGrids, Data.DB, DMMain;

type
  TManagerForm = class(TForm)
    PanelHeaderManager: TPanel;
    LabelAssess360A: TLabel;
    PanelManagerSidebar: TPanel;
    BtnManagerViewProj: TButton;
    BtnManagerAssessEmp: TButton;
    BtnManagerAboutMe: TButton;
    PanelManagerAboutMe: TPanel;
    ImgManagerAboutMe: TImage;
    LblNameManagerAM: TLabel;
    LblEmailManagerAM: TLabel;
    LblRoleManagerAM: TLabel;
    LblSubroleManagerAM: TLabel;
    PanelManagerAboutMeHeader: TPanel;
    EditNameManagerAM: TEdit;
    EditEmailManagerAM: TEdit;
    EditRoleManagerAM: TEdit;
    EditSubroleManagerAM: TEdit;
    PanelManager: TPanel;
    PanelManagerViewProjects: TPanel;
    PanelManagerViewProjHeader: TPanel;
    DBGridVAP: TDBGrid;
    LblManagerViewSpecificEmployees: TLabel;
    ListBox1: TListBox;
    ScrollBoxManagerAssessEmployees: TScrollBox;
    PanelManagerAssessEmployeeHeader: TPanel;
    Label1: TLabel;
    DBGrid2: TDBGrid;
    ScrollBox2: TScrollBox;
    procedure BtnManagerAboutMeClick(Sender: TObject);
    procedure BtnManagerViewProjClick(Sender: TObject);
    procedure BtnManagerAssessEmpClick(Sender: TObject);
    procedure FormShow(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  ManagerForm: TManagerForm;

implementation

{$R *.dfm}

procedure TManagerForm.BtnManagerAboutMeClick(Sender: TObject);
begin
  BtnManagerViewProj.SendToBack;
  ScrollBoxManagerAssessEmployees.SendToBack;
  PanelManagerAboutMe.BringToFront;
end;

procedure TManagerForm.BtnManagerAssessEmpClick(Sender: TObject);
begin
  BtnManagerViewProj.SendToBack;
  ScrollBoxManagerAssessEmployees.BringToFront;
  PanelManagerAboutMe.SendToBack;
end;

procedure TManagerForm.BtnManagerViewProjClick(Sender: TObject);
begin
  BtnManagerViewProj.BringToFront;
  ScrollBoxManagerAssessEmployees.SendToBack;
  PanelManagerAboutMe.SendToBack;
end;

procedure TManagerForm.FormShow(Sender: TObject);
begin
  with DataModule1.qryManagerViewAllProj do
  begin
    Close;
    SQL.Text :=
      'SELECT p.project_id, p.title AS project_name, ' +
      'e.name AS employee_name, e.email AS employee_email, ' +
      'e.role AS employee_role, s.subrole_roles AS employee_subrole ' +
      'FROM project_assignments pa ' +
      'JOIN projects p ON pa.project_id = p.project_id ' +
      'JOIN users e ON pa.employee_id = e.user_id ' +
      'LEFT JOIN subrole s ON e.subrole_id = s.subrole_id ' +
      'WHERE pa.manager_id = ' + QuotedStr(IntToStr(DataModule1.LoggedInUserID));

    Open;
  end;
end;

end.
